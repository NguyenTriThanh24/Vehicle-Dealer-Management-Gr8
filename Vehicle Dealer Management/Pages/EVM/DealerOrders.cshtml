@page
@model Vehicle_Dealer_Management.Pages.EVM.DealerOrdersModel
@{
    ViewData["Title"] = "ƒê∆°n ƒë·∫∑t h√†ng t·ª´ ƒë·∫°i l√Ω";
    ViewData["UserRole"] = "EVM_STAFF";
    ViewData["UserName"] = HttpContext.Session.GetString("UserName") ?? "EVM Staff";
}

<div class="content-header">
    <h1 class="content-title">ƒê∆°n ƒë·∫∑t h√†ng t·ª´ ƒë·∫°i l√Ω</h1>
    <p class="content-subtitle">X·ª≠ l√Ω v√† duy·ªát ƒë∆°n ƒë·∫∑t h√†ng</p>
</div>

<!-- Status Tabs -->
<div class="card mb-4">
    <div class="card-body" style="padding: 0;">
        <div style="display: flex; border-bottom: 1px solid var(--border); gap: 1rem;">
            <a href="?status=SUBMITTED" class="tab-btn @(Model.StatusFilter == "SUBMITTED" ? "active" : "")" style="padding: 1rem 2rem; text-decoration: none; color: inherit; border-bottom: 2px solid @(Model.StatusFilter == "SUBMITTED" ? "var(--accent-cyan)" : "transparent");">
                Ch·ªù duy·ªát (@Model.SubmittedCount)
            </a>
            <a href="?status=APPROVED" class="tab-btn @(Model.StatusFilter == "APPROVED" ? "active" : "")" style="padding: 1rem 2rem; text-decoration: none; color: inherit; border-bottom: 2px solid @(Model.StatusFilter == "APPROVED" ? "var(--accent-cyan)" : "transparent");">
                ƒê√£ duy·ªát (@Model.ApprovedCount)
            </a>
            <a href="?status=FULFILLING" class="tab-btn @(Model.StatusFilter == "FULFILLING" ? "active" : "")" style="padding: 1rem 2rem; text-decoration: none; color: inherit; border-bottom: 2px solid @(Model.StatusFilter == "FULFILLING" ? "var(--accent-cyan)" : "transparent");">
                ƒêang giao (@Model.FulfillingCount)
            </a>
            <a href="?status=ALL" class="tab-btn @(Model.StatusFilter == "ALL" ? "active" : "")" style="padding: 1rem 2rem; text-decoration: none; color: inherit; border-bottom: 2px solid @(Model.StatusFilter == "ALL" ? "var(--accent-cyan)" : "transparent");">
                T·∫•t c·∫£
            </a>
        </div>
    </div>
</div>

<!-- Orders List -->
<div class="card">
    <div class="card-body">
        @if (Model.Orders.Any())
        {
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>M√£ ƒë∆°n</th>
                            <th>ƒê·∫°i l√Ω</th>
                            <th>Ng√†y ƒë·∫∑t</th>
                            <th>S·ªë l∆∞·ª£ng xe</th>
                            <th>Gi√° tr·ªã ∆∞·ªõc t√≠nh</th>
                            <th>Tr·∫°ng th√°i</th>
                            <th>Ng∆∞·ªùi t·∫°o</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var order in Model.Orders)
                        {
                            <tr>
                                <td><strong>#@order.Id</strong></td>
                                <td>
                                    <div><strong>@order.DealerName</strong></div>
                                    <div class="text-muted" style="font-size: 0.875rem;">@order.DealerCode</div>
                                </td>
                                <td>@order.CreatedAt.ToString("dd/MM/yyyy HH:mm")</td>
                                <td>
                                    <strong style="font-size: 1.125rem;">@order.VehicleCount</strong>
                                    <span class="text-muted">xe</span>
                                </td>
                                <td><strong>@order.EstimatedValue.ToString("N0") VND</strong></td>
                                <td>@await Html.PartialAsync("_StatusBadge", order.Status)</td>
                                <td class="text-muted">@order.CreatedByName</td>
                                <td>
                                    <a href="/EVM/DealerOrderDetail?id=@order.Id" class="btn btn-primary btn-sm">
                                        @if (order.Status == "SUBMITTED")
                                        {
                                            <i class="bi bi-check-circle"></i> <text>Duy·ªát</text>
                                        }
                                        else
                                        {
                                            <i class="bi bi-eye"></i> <text>Chi ti·∫øt</text>
                                        }
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
        else
        {
            <div class="empty-state">
                <div class="empty-state-icon">üì¶</div>
                <div class="empty-state-title">Kh√¥ng c√≥ ƒë∆°n ƒë·∫∑t h√†ng</div>
                <div class="empty-state-text">Ch∆∞a c√≥ ƒë∆°n ƒë·∫∑t h√†ng n√†o t·ª´ ƒë·∫°i l√Ω</div>
            </div>
        }
    </div>
</div>

@section Scripts {
    <style>
        .tab-btn:hover {
            background: rgba(255, 255, 255, 0.05);
        }
    </style>
}

