@page
@model Vehicle_Dealer_Management.Pages.DealerManager.DashboardModel
@{
    ViewData["Title"] = "Dashboard - Qu·∫£n l√Ω ƒë·∫°i l√Ω";
    ViewData["UserRole"] = "DEALER_MANAGER";
    ViewData["UserName"] = Model.UserName;
}

<div class="content-header">
    <h1 class="content-title">Dashboard - @Model.DealerName</h1>
    <p class="content-subtitle">T·ªïng quan hi·ªáu su·∫•t v√† b√°o c√°o</p>
</div>

<!-- Stats Row -->
<div class="grid grid-cols-4 mb-4">
    <div class="stat-card">
        <div class="flex justify-between items-center">
            <div class="stat-label">Doanh s·ªë th√°ng n√†y</div>
            <i class="bi bi-cash-stack" style="font-size: 1.5rem; color: var(--success);"></i>
        </div>
        <div class="stat-value">@Model.MonthSales.ToString("N0")</div>
        <div class="stat-change positive">
            <i class="bi bi-arrow-up"></i>
            <span>+18% so v·ªõi th√°ng tr∆∞·ªõc</span>
        </div>
    </div>

    <div class="stat-card">
        <div class="flex justify-between items-center">
            <div class="stat-label">ƒê∆°n h√†ng</div>
            <i class="bi bi-receipt" style="font-size: 1.5rem; color: var(--accent-cyan);"></i>
        </div>
        <div class="stat-value">@Model.TotalOrders</div>
        <div class="stat-change positive">
            <i class="bi bi-arrow-up"></i>
            <span>+12 ƒë∆°n m·ªõi</span>
        </div>
    </div>

    <div class="stat-card">
        <div class="flex justify-between items-center">
            <div class="stat-label">Nh√¢n vi√™n</div>
            <i class="bi bi-people" style="font-size: 1.5rem; color: var(--info);"></i>
        </div>
        <div class="stat-value">@Model.TotalStaff</div>
        <div class="stat-change neutral">
            <span>@Model.ActiveStaff ƒëang ho·∫°t ƒë·ªông</span>
        </div>
    </div>

    <div class="stat-card">
        <div class="flex justify-between items-center">
            <div class="stat-label">C√¥ng n·ª£</div>
            <i class="bi bi-credit-card" style="font-size: 1.5rem; color: var(--warning);"></i>
        </div>
        <div class="stat-value">@Model.TotalDebt.ToString("N0")</div>
        <div class="stat-change negative">
            <i class="bi bi-arrow-down"></i>
            <span>C·∫ßn theo d√µi</span>
        </div>
    </div>
</div>

<!-- Sales by Staff -->
<div class="card mb-4">
    <div class="card-header">
        <div class="flex justify-between items-center">
            <h3 class="card-title mb-0">Doanh s·ªë theo nh√¢n vi√™n (Th√°ng n√†y)</h3>
            <a href="/DealerManager/Reports/SalesByStaff" class="btn btn-secondary btn-sm">Xem b√°o c√°o chi ti·∫øt</a>
        </div>
    </div>
    <div class="card-body">
        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th>Nh√¢n vi√™n</th>
                        <th>S·ªë ƒë∆°n h√†ng</th>
                        <th>Doanh s·ªë</th>
                        <th>% Ho√†n th√†nh m·ª•c ti√™u</th>
                        <th>X·∫øp h·∫°ng</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var staff in Model.StaffPerformance)
                    {
                        <tr>
                            <td><strong>@staff.Name</strong></td>
                            <td>@staff.OrderCount</td>
                            <td><strong>@staff.Sales.ToString("N0") VND</strong></td>
                            <td>
                                <div class="flex items-center gap-2">
                                    <div style="width: 100px; height: 8px; background: var(--border); border-radius: 4px; overflow: hidden;">
                                        <div style="width: @staff.TargetPercent%; height: 100%; background: var(--success);"></div>
                                    </div>
                                    <span>@staff.TargetPercent%</span>
                                </div>
                            </td>
                            <td>
                                @if (staff.Rank == 1)
                                {
                                    <span class="badge badge-success">üèÜ #@staff.Rank</span>
                                }
                                else
                                {
                                    <span class="badge badge-default">#@staff.Rank</span>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Charts and Reports -->
<div class="grid grid-cols-2">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title mb-0">Doanh s·ªë theo tu·∫ßn</h3>
        </div>
        <div class="card-body">
            <div class="chart-container">
                <div class="chart-placeholder">
                    <i class="bi bi-bar-chart" style="font-size: 4rem; opacity: 0.3;"></i>
                    <p>Bi·ªÉu ƒë·ªì doanh s·ªë (Chart.js placeholder)</p>
                </div>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3 class="card-title mb-0">C√¥ng n·ª£ kh√°ch h√†ng</h3>
        </div>
        <div class="card-body">
            @if (Model.CustomerDebts.Any())
            {
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Kh√°ch h√†ng</th>
                                <th>S·ªë n·ª£</th>
                                <th>H·∫°n thanh to√°n</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var debt in Model.CustomerDebts)
                            {
                                <tr>
                                    <td>@debt.CustomerName</td>
                                    <td><strong style="color: var(--error);">@debt.Amount.ToString("N0") VND</strong></td>
                                    <td>@debt.DueDate.ToString("dd/MM/yyyy")</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
            else
            {
                <div class="empty-state">
                    <div class="empty-state-icon">‚úÖ</div>
                    <div class="empty-state-text">Kh√¥ng c√≥ c√¥ng n·ª£</div>
                </div>
            }
        </div>
    </div>
</div>

