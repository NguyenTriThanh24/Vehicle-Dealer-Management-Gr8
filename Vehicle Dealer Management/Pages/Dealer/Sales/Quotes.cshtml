@page
@model Vehicle_Dealer_Management.Pages.Dealer.Sales.QuotesModel
@{
    ViewData["Title"] = "Danh s√°ch b√°o gi√°";
    ViewData["UserRole"] = "DEALER_STAFF";
    ViewData["UserName"] = HttpContext.Session.GetString("UserName") ?? "User";
}

<div class="content-header">
    <div class="flex justify-between items-center">
        <div>
            <h1 class="content-title">Danh s√°ch b√°o gi√°</h1>
            <p class="content-subtitle">Qu·∫£n l√Ω b√°o gi√° cho kh√°ch h√†ng</p>
        </div>
        <a href="/Dealer/Sales/CreateQuote" class="btn btn-primary">
            <i class="bi bi-plus-circle"></i> T·∫°o b√°o gi√° m·ªõi
        </a>
    </div>
</div>

<!-- Stats -->
<div class="grid grid-cols-4 mb-4">
    <div class="stat-card">
        <div class="stat-label">T·ªïng s·ªë</div>
        <div class="stat-value">@Model.TotalCount</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">ƒê√£ g·ª≠i</div>
        <div class="stat-value" style="color: var(--info);">@Model.SentCount</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">ƒê√£ ch·∫•p nh·∫≠n</div>
        <div class="stat-value" style="color: var(--success);">@Model.AcceptedCount</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">ƒê√£ t·ª´ ch·ªëi</div>
        <div class="stat-value" style="color: var(--error);">@Model.RejectedCount</div>
    </div>
</div>

<!-- Filter Tabs -->
<div class="card mb-4">
    <div class="card-body" style="padding: 0;">
        <div style="display: flex; border-bottom: 1px solid var(--border);">
            <a href="?status=all" class="tab-btn @(Model.StatusFilter == "all" ? "active" : "")" style="padding: 1rem 2rem; text-decoration: none; color: inherit; border-bottom: 2px solid @(Model.StatusFilter == "all" ? "var(--accent-cyan)" : "transparent");">
                T·∫•t c·∫£ (@Model.TotalCount)
            </a>
            <a href="?status=SENT" class="tab-btn @(Model.StatusFilter == "SENT" ? "active" : "")" style="padding: 1rem 2rem; text-decoration: none; color: inherit; border-bottom: 2px solid @(Model.StatusFilter == "SENT" ? "var(--accent-cyan)" : "transparent");">
                ƒê√£ g·ª≠i (@Model.SentCount)
            </a>
            <a href="?status=ACCEPTED" class="tab-btn @(Model.StatusFilter == "ACCEPTED" ? "active" : "")" style="padding: 1rem 2rem; text-decoration: none; color: inherit; border-bottom: 2px solid @(Model.StatusFilter == "ACCEPTED" ? "var(--accent-cyan)" : "transparent");">
                ƒê√£ ch·∫•p nh·∫≠n (@Model.AcceptedCount)
            </a>
            <a href="?status=REJECTED" class="tab-btn @(Model.StatusFilter == "REJECTED" ? "active" : "")" style="padding: 1rem 2rem; text-decoration: none; color: inherit; border-bottom: 2px solid @(Model.StatusFilter == "REJECTED" ? "var(--accent-cyan)" : "transparent");">
                ƒê√£ t·ª´ ch·ªëi (@Model.RejectedCount)
            </a>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-body">
        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th>M√£</th>
                        <th>Kh√°ch h√†ng</th>
                        <th>Ng√†y t·∫°o</th>
                        <th>Tr·∫°ng th√°i</th>
                        <th>T·ªïng ti·ªÅn</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model.Quotes.Any())
                    {
                        @foreach (var quote in Model.Quotes)
                        {
                            <tr>
                                <td><strong>#@quote.Id</strong></td>
                                <td>@quote.CustomerName</td>
                                <td>@quote.CreatedAt.ToString("dd/MM/yyyy")</td>
                                <td>@await Html.PartialAsync("_StatusBadge", quote.Status)</td>
                                <td><strong>@quote.Total.ToString("N0") VND</strong></td>
                                <td class="text-right">
                                    <a href="/Dealer/Sales/QuoteDetail?id=@quote.Id" class="btn btn-secondary btn-sm">
                                        <i class="bi bi-eye"></i> Chi ti·∫øt
                                    </a>
                                </td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="6">
                                <div class="empty-state">
                                    <div class="empty-state-icon">üìÑ</div>
                                    <div class="empty-state-title">Ch∆∞a c√≥ b√°o gi√°</div>
                                    <div class="empty-state-text">T·∫°o b√°o gi√° m·ªõi cho kh√°ch h√†ng</div>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

